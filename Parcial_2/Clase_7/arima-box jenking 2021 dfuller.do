*:::::::::::::: Metodologia de Box-Jenkins*para estimar AR y MA se requiere estacionariedad*Usamos la base de datos de indice de precios al por mayor de EEUU*use http://www.stata-press.com/data/r15/wpi1tsset tdescribe wpisum wpi*::::::::::::::1 PASO -> ANALIZAR LA ESTACIONARIEDAD :::::::::::::::::::::tsline wpi, name(gwpi)   /*solo permite generar una vez*/tsline wpi*si no aparece algo estacionario se puede aplicar loggen lwpi=ln(wpi)tsline lwpisum lwpitsline lwpi, yline(`r(mean)')    /* para un gráfico extra */*una alternativa es probar la primera diferenciasum d.lwpitsline d.lwpi, yline(`r(mean)')tsline d.lwpigen dlwpi=d.lwpi   /*OJO, esta es la estacionaria y lo demás no usa a la variable*/***************************************reg lwpi l.lwpi   /*el modelo es NO estacionario*/*pruebas graficas o correlogramasac wpi    /* es el fas */pac wpi   /* es el fap */*parece un proceso AR(2)reg wpi l.wpi          /*OJO AR(1) es no estacionario*/reg wpi l.wpi l2.wpi   /*para un AR(2) */ac wpi, name (gac)pac wpi, name (gpac)graph combine gac gpac* las pruebas con wpi no son adecuadas, se debe trabajar con dlwpiac dlwpi, name (lgac)pac dlwpi, name (lgpac)graph combine lgac lgpacac dlwpipac dlwpireg dlwpi l.dlwpi        /*es el AR(1) de la variable dif */reg dlwpi l.dlwpi l2.dlwpi     /*es el AR(2) de la variable dif */* por los resultados del fas y fap probamos lo siguiente:* si fuera un MA(1) o MA(2)arima dlwpi, arima(0,0,1)arima dlwpi, arima(0,0,2)* si fuera un AR(1) o AR(2)arima dlwpi, arima(1,0,0)arima dlwpi, arima(2,0,0)* si fuera una ARMAarima dlwpi, arima(1,0,1)arima dlwpi, arima(2,0,1)   /*no es*/arima dlwpi, arima(1,0,2)   /*no es*/arima dlwpi, arima(2,0,2)   /*no es*/arima lwpi, arima(1,1,1)*************************************solo como alternativa para ver un proceso estacionario*gen dwpi=d.wpireg dlwpi l.dlwpi*ESTE DEBERIA SER EL PRIMER PASO AHORA QUE SABEMOS LA DIFERENCIA ENTRE*UN MODELO ESTACIONARIO Y NO ESTACIONARIO*pruebas formales Pruebas de Raiz Unitariadfuller lwpidfuller lwpi, trend regress lags(12)dfuller wpidfuller d.wpidfuller dlwpi, trend regress lags(12)   /*ojo al 99% confianza*/gen ddlwpi=d.dlwpidfuller ddlwpi, trend regress lags(12)*H0: la serie es Estacionaria*el valor estimado (test statistic) debe ser menor al valor crítico*el p-value tambien debe ser menor al 1%*::::::::::::::2 PASO -> TRANSFORMACION DE LA SERIE :::::::::::::::::::::*si yt no es estacionario-->> diferenciamos*se puede aplicar cualquiera de las siguientes 2 tecnicas*gen dwpi= wpi-l.wpi /* restar el valor actual al pasado*/*gen dwpi2= d.ln_wpi  /*aplicando el operador de diferencias*/* gen ddlwpi=d.dlwpi   OJO ya esta creada mas arriba* ojo se trabaja con dlwpi que ya estaba creadatsline ddlwpi, name(g1)tsline ddlwpisum ddlwpitsline ddlwpi, yline(`r(mean)')*graph combine wpi dlwpi*dfuller ddwpi      /* para verificar que la variable es estacionaria*/*::::::::::::::3 PASO -> IDENTIFICAR EL MODELO :::::::::::::::::::::ac ddlwpi, name (gac1)pac ddlwpi, name (gpac1)graph combine gac1 gpac1* OJO se debe recordar las gráficas FAS y FAP*AC -> orden de los MA(1)*PAC-> orden de los AR(3)*a continuación se muestran distintas combinaciones de los modelos arima*nos interesa ver la significancia estadística individualarima ddlwpi, arima(1,0,1)arima ddlwpi, arima(2,0,1)arima ddlwpi, arima(3,0,1)arima lwpi, arima(3,2,1)arima ddlwpi, arima(1,0,0)arima ddlwpi, arima(2,0,0)arima ddlwpi, arima(3,0,0)arima ddlwpi, arima(0,0,1)arima ddlwpi, arima(0,0,2)   /*no es*/*:::::::::::::: 4 PASO -> VALIDACION DEL MODELO :::::::::::::::::::::*mejor modelo es el mas parsimonioso (el que mejor se ajusta) *test de portmanteau*H0: el proceso el ruido blanco*---ARIMA(1,1) quietly arima ddlwpi, arima(1,0,1)predict resid11, residwntestq resid11   /* si el valor p>0.05 entonces hay RB */wntestb resid11   /* es otro test denominado Periodograma */estat ic    /* sirve para estimar los criterios de informacion asintóticossirve para comparar modelos y se elige el menor valor Akaike */*la media del error debe ser cerosummarize resid11scalar media_error11= r(mean)tsline resid11, yline(`r(mean)')*---ARIMA(2,1) quietly arima ddlwpi, arima(2,0,1)predict resid21, residwntestq resid21   /* si el valor p>0.05 entonces hay RB */wntestb resid21   /* es otro test denominado Periodograma */estat ic*---ARIMA(3,1) quietly arima ddlwpi, arima(3,0,1)predict resid31, residwntestq resid31   /* si el valor p>0.05 entonces hay RB */wntestb resid31   /* es otro test denominado Periodograma */estat ic*---AR(1) quietly arima ddlwpi, arima(1,0,0)predict resid10, residwntestq resid10   /* si el valor p>0.05 entonces hay RB */wntestb resid10   /* es otro test denominado Periodograma */estat ic*---AR(2) quietly arima ddlwpi, arima(2,0,0)predict resid20, residwntestq resid20   /* si el valor p>0.05 entonces hay RB */wntestb resid20   /* es otro test denominado Periodograma */estat ic*---AR(3) quietly arima ddlwpi, arima(3,0,0)predict resid30, residwntestq resid30   /* si el valor p>0.05 entonces hay RB */wntestb resid30   /* es otro test denominado Periodograma */estat ic*---MA(1) quietly arima ddlwpi, arima(0,0,1)predict resid01, residwntestq resid01   /* si el valor p>0.05 entonces hay RB */wntestb resid01   /* es otro test denominado Periodograma */estat ic*---MA(2) quietly arima ddlwpi, arima(0,0,2)predict resid02, residwntestq resid02   /* si el valor p>0.05 entonces hay RB */wntestb resid02   /* es otro test denominado Periodograma */estat ic*el modelo preferible (parsimonioso) es el MA(1)*:::::::::::::: 5 PASO -> PREDICCION :::::::::::::::::::::tsappend, add(10)   /*es para incrementar 10 espacios de la BD*/arima ddlwpi, arima(0,0,1) //Modelo seleccionadopredict ddlwpif, y dynamic(q(1990q4))*predict ddlwpif, y dynamic(2020)  tsline ddlwpif ddlwpi*cor ddlwpif ddlwpi**** los calculos terminan aqui **** 